name: "Modan Bags Co.il"
description: "Recipe for modanbags.co.il Hebrew e-commerce site selling school supplies and bags"
version: "1.0.0"
siteUrl: "https://modanbags.co.il"

selectors:
  # Core product fields
  title: 
    - "h1"
    - ".product_title"
    - ".product-name"
    - ".title"
    - "h2"
  
  price:
    - ".price"
    - ".amount"
    - ".product-price"
    - "[data-price]"
    - ".woocommerce-Price-amount"
    - ".price .amount"
  
  sku:
    - ".sku"
    - ".product-sku"
    - "[data-sku]"
    - ".product-code"
  
  description:
    - ".product-description"
    - ".description"
    - ".product-details"
    - ".woocommerce-product-details__short-description"
    - ".excerpt"
  
  shortDescription:
    - ".product-summary"
    - ".short-description"
    - ".excerpt"
  
  images:
    - ".product-gallery img"
    - ".product-images img"
    - ".gallery img"
    - ".woocommerce-product-gallery__image img"
    - "img[src*='product']"
    - "img"
  
  stock:
    - ".stock"
    - ".availability"
    - ".in-stock"
    - ".out-of-stock"
    - ".stock-status"
  
  category:
    - ".woocommerce-breadcrumb"
    - ".breadcrumb"
    - ".category"
    - ".product-category"
    - "nav.breadcrumb"
    - ".woocommerce-breadcrumb a"
    - ".breadcrumb a"
    - "a[href*='product-category']"
    - ".woocommerce-breadcrumb span"
    - ".breadcrumb span"
    - "span[class*='breadcrumb']"
    - ".woocommerce-breadcrumb .breadcrumb-sep + span"
    - ".breadcrumb .breadcrumb-sep + span"
  
  # Product discovery - specific to modanbags.co.il structure
  productLinks:
    - ".woocommerce ul.products li.product a"
    - ".woocommerce-loop-product__title"
    - ".product a"
    - ".product-item a"
    - ".product-card a"
    - "a[href*='/product/']"
    - "a[href*='/מוצר/']"
    - "li.product a"
    - ".products li a"
    - ".woocommerce ul.products li.product .woocommerce-loop-product__title"
    - ".woocommerce ul.products li.product h2 a"
    - ".woocommerce ul.products li.product h3 a"
  
  # Pagination
  pagination:
    nextPage: ".next.page-numbers"
    maxPages: 1  # Limit to current page only for now
  
  # Attributes and variations
  attributes:
    - ".variations"
    - ".product-options"
    - ".product-attributes"
    - ".woocommerce-variation-add-to-cart"
    - ".woocommerce-variations"
    - ".variations_form"
    - ".product-variations"
    - "select[name='attribute_pa_general']"
    - "select[name*='attribute']"
    - ".woocommerce-variation-add-to-cart .variations select"
    - "form.variations_form"
    - ".variations_form"
    - ".woocommerce-variations"
    - ".product form"
    - "form[class*='variations']"
    - "form[class*='woocommerce']"
    - ".variations select"
    - "select[class*='variation']"
    - "select[class*='attribute']"
    - ".woocommerce-variation-add-to-cart"
    - ".variations_form .variations"
    - ".woocommerce-variations .variations"
  
  variations:
    - ".variations_form"
    - ".product-variations"
    - ".woocommerce-variations"
    - ".woocommerce-variation-add-to-cart"
    - "form.variations_form"
    - ".product form"
    - ".variations"
    - ".product-options"
    - "select[name*='attribute']"
    - ".woocommerce-variation-add-to-cart .variations"
    - ".variations select"
    - ".product-attributes select"
    - ".product-options select"
    - "select[class*='variation']"
    - "select[class*='attribute']"
    - "form[class*='variations']"
    - "form[class*='woocommerce']"
    - ".variations_form"
    - ".woocommerce-variations"
    - ".variations_form .variations"
    - ".woocommerce-variations .variations"
    - ".variations_form select"
    - ".woocommerce-variations select"
    - "select[name*='attribute_pa_']"
    - "select[name*='attribute_']"
    - "select[name*='pa_']"
  
  # Additional variation detection selectors
  variationForm:
    - "form.variations_form"
    - ".variations_form"
    - ".woocommerce-variations"
    - "form[class*='variations']"
    - "form[class*='woocommerce']"
    - ".product form"
    - "form[data-product_id]"
    - ".woocommerce-variation-add-to-cart"
    - ".variations_form .variations"
    - ".woocommerce-variations .variations"
  
  variationSelects:
    - "select[name*='attribute_pa_']"
    - "select[name*='attribute_']"
    - "select[name*='pa_']"
    - "select[class*='variation']"
    - "select[class*='attribute']"
    - ".variations select"
    - ".woocommerce-variations select"
    - ".variations_form select"
    - ".product-options select"
    - ".product-attributes select"
    - "select[name='attribute_pa_general']"
    - "select[name='attribute_pa_color']"
    - "select[name='attribute_pa_size']"
    - "select[name='attribute_pa_material']"
  
  variationOptions:
    - "select[name='attribute_pa_general'] option"
    - "select[name*='attribute'] option"
    - ".variations select option"
    - ".woocommerce-variations select option"
    - ".product-options select option"
    - ".product-attributes select option"
    - "option[value*='attribute']"
    - ".variation-option"
    - ".product-variation-option"
    - "select[name*='attribute_pa_'] option"
    - "select[name*='attribute_'] option"
    - "select[name*='pa_'] option"
    - ".variations_form select option"
    - ".woocommerce-variations select option"
    - "option[value*='pa_']"
    - "option[value*='attribute_']"
    - "option[value*='general']"
    - "option[value*='color']"
    - "option[value*='size']"
    - "option[value*='material']"
  
  variationValues:
    - ".variations select option[selected]"
    - ".woocommerce-variations select option[selected]"
    - ".product-options select option[selected]"
    - ".product-attributes select option[selected]"
    - "select[name*='attribute'] option[selected]"
    - ".variation-selected"
    - ".product-variation-selected"
    - "select[name*='attribute_pa_'] option[selected]"
    - "select[name*='attribute_'] option[selected]"
    - "select[name*='pa_'] option[selected]"
    - ".variations_form select option[selected]"
    - ".woocommerce-variations select option[selected]"
    - "option[selected][value*='pa_']"
    - "option[selected][value*='attribute_']"
  
  # JavaScript and dynamic content variation detection
  dynamicVariations:
    - "[data-variation]"
    - "[data-attribute]"
    - "[data-product_variations]"
    - "[data-variation_id]"
    - ".variation"
    - ".product-variation"
    - ".woocommerce-variation"
    - ".variation-item"
    - ".variation-option"
    - ".product-variation-option"
    - ".variation-selector"
    - ".product-variation-selector"
    - ".variation-dropdown"
    - ".product-variation-dropdown"
    - ".variation-list"
    - ".product-variation-list"
    - ".variation-grid"
    - ".product-variation-grid"
    - ".variation-table"
    - ".product-variation-table"
    - ".variation-form"
    - ".product-variation-form"
    - ".variation-wrapper"
    - ".product-variation-wrapper"
    - ".variation-container"
    - ".product-variation-container"
    - ".variation-section"
    - ".product-variation-section"
    - ".variation-area"
    - ".product-variation-area"
    - ".variation-block"
    - ".product-variation-block"
    - ".variation-panel"
    - ".product-variation-panel"
    - ".variation-tab"
    - ".product-variation-tab"
    - ".variation-content"
    - ".product-variation-content"
    - ".variation-header"
    - ".product-variation-header"
    - ".variation-body"
    - ".product-variation-body"
    - ".variation-footer"
    - ".product-variation-footer"
  
  # Embedded data sources
  embeddedJson:
    - "script[type='application/ld+json']"
    - "script[data-json]"
    - "#__NEXT_DATA__"

transforms:
  title:
    - "trim: "
    - "replace:^\\s+|\\s+$"
    - "replace:^\\s*-\\s*"
  
  price:
    - "replace:[^\\d.,]"
    - "replace:,|."
    - "replace:₪|$|€|£"
  
  description:
    - "trim: \n\t"
    - "replace:\\s+ | "
    - "replace:^\\s*-\\s*"
  
  attributes:
    צבע:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
      - "replace:בחר צבע|בחרי צבע"
    גודל:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
      - "replace:בחר גודל|בחרי גודל"
    Color:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
    Size:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
    General:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
      - "replace:בחירת אפשרות|בחר אפשרות"
    Material:
      - "replace:^\\s+|\\s+$"
      - "replace:^\\s*-\\s*"
      - "replace:בחר חומר|בחרי חומר"
  
  variations:
    - "replace:^\\s+|\\s+$"
    - "replace:^\\s*-\\s*"
    - "replace:בחירת אפשרות|בחר אפשרות"
    - "replace:בחירת צבע|בחר צבע"
    - "replace:בחירת גודל|בחר גודל"
    - "replace:בחירת חומר|בחר חומר"
    - "replace:בחירת אפשרותA|בחירת אפשרותB|בחירת אפשרותC"
    - "replace:בחירת אפשרות1|בחירת אפשרות2|בחירת אפשרות3"

behavior:
  waitForSelectors:
    - "h1"
    - ".price"
    - ".product_title"
    - ".product-price"
    - ".variations_form"
    - ".woocommerce-variations"
    - "form[class*='variations']"
    - "select[name*='attribute']"
    - "[data-variation]"
    - "[data-attribute]"
    - "[data-product_variations]"
    - ".variation"
    - ".product-variation"
    - ".woocommerce-variation"
  scrollToLoad: false
  useHeadlessBrowser: true  # Enable Puppeteer for variation detection
  rateLimit: 1000  # Faster rate limiting
  maxConcurrent: 1  # Process one at a time to avoid overwhelming
  waitForVariations: true  # Wait for variations on product pages
  waitForDynamicContent: true
  waitForJavaScript: true
  waitForVariationForm: true
  waitForVariationSelects: true
  waitForVariationOptions: true
  waitForVariationValues: true
  waitForWooCommerceVariations: true

fallbacks:
  title:
    - "h1"
    - ".title"
    - "h2"
  price:
    - ".price"
    - ".amount"
    - "[data-price]"
  images:
    - "img[src*='product']"
    - "img"

validation:
  requiredFields:
    - "title"
    - "price"
    - "images"
  priceFormat: "\\d+(\\.\\d{2})?"
  skuFormat: "[A-Za-z0-9-_א-ת]+"
  variationDetection:
    - "variationForm"
    - "variationSelects"
    - "variationOptions"
    - "variationValues"
  variationValidation:
    - "hasVariationForm"
    - "hasVariationSelects"
    - "hasVariationOptions"
    - "hasVariationValues"
  variationFallbacks:
    - "form[class*='variations']"
    - "select[name*='attribute']"
    - "option[value*='attribute']"
    - ".variations"
    - ".woocommerce-variations"
    - "[data-variation]"
    - "[data-attribute]"
    - "[data-product_variations]"
    - ".variation"
    - ".product-variation"
    - ".woocommerce-variation"
    - ".variation-item"
    - ".variation-option"
    - ".product-variation-option"
    - ".variation-selector"
    - ".product-variation-selector"
    - ".variation-dropdown"
    - ".product-variation-dropdown"
    - ".variation-list"
    - ".product-variation-list"
    - ".variation-grid"
    - ".product-variation-grid"
    - ".variation-table"
    - ".product-variation-table"
    - ".variation-form"
    - ".product-variation-form"
    - ".variation-wrapper"
    - ".product-variation-wrapper"
    - ".variation-container"
    - ".product-variation-container"
    - ".variation-section"
    - ".product-variation-section"
    - ".variation-area"
    - ".product-variation-area"
    - ".variation-block"
    - ".product-variation-block"
    - ".variation-panel"
    - ".product-variation-panel"
    - ".variation-tab"
    - ".product-variation-tab"
    - ".variation-content"
    - ".product-variation-content"
    - ".variation-header"
    - ".product-variation-header"
    - ".variation-body"
    - ".product-variation-body"
    - ".variation-footer"
    - ".product-variation-footer"

  # JavaScript-based variation detection
  javascriptVariations:
    - "document.querySelector('.variations_form')"
    - "document.querySelector('.woocommerce-variations')"
    - "document.querySelector('form[class*=\"variations\"]')"
    - "document.querySelector('form[class*=\"woocommerce\"]')"
    - "document.querySelector('.product form')"
    - "document.querySelector('form[data-product_id]')"
    - "document.querySelector('.woocommerce-variation-add-to-cart')"
    - "document.querySelector('.variations_form .variations')"
    - "document.querySelector('.woocommerce-variations .variations')"
    - "document.querySelector('select[name*=\"attribute\"]')"
    - "document.querySelector('select[name*=\"pa_\"]')"
    - "document.querySelector('select[class*=\"variation\"]')"
    - "document.querySelector('select[class*=\"attribute\"]')"
    - "document.querySelector('.variations select')"
    - "document.querySelector('.woocommerce-variations select')"
    - "document.querySelector('.variations_form select')"
    - "document.querySelector('.product-options select')"
    - "document.querySelector('.product-attributes select')"
    - "document.querySelector('select[name=\"attribute_pa_general\"]')"
    - "document.querySelector('select[name=\"attribute_pa_color\"]')"
    - "document.querySelector('select[name=\"attribute_pa_size\"]')"
    - "document.querySelector('select[name=\"attribute_pa_material\"]')"
    - "document.querySelector('[data-variation]')"
    - "document.querySelector('[data-attribute]')"
    - "document.querySelector('[data-product_variations]')"
    - "document.querySelector('.variation')"
    - "document.querySelector('.product-variation')"
    - "document.querySelector('.woocommerce-variation')"
    - "document.querySelector('.variation-item')"
    - "document.querySelector('.variation-option')"
    - "document.querySelector('.product-variation-option')"
    - "document.querySelector('.variation-selector')"
    - "document.querySelector('.product-variation-selector')"
    - "document.querySelector('.variation-dropdown')"
    - "document.querySelector('.product-variation-dropdown')"
    - "document.querySelector('.variation-list')"
    - "document.querySelector('.product-variation-list')"
    - "document.querySelector('.variation-grid')"
    - "document.querySelector('.product-variation-grid')"
    - "document.querySelector('.variation-table')"
    - "document.querySelector('.product-variation-table')"
    - "document.querySelector('.variation-form')"
    - "document.querySelector('.product-variation-form')"
    - "document.querySelector('.variation-wrapper')"
    - "document.querySelector('.product-variation-wrapper')"
    - "document.querySelector('.variation-container')"
    - "document.querySelector('.product-variation-container')"
    - "document.querySelector('.variation-section')"
    - "document.querySelector('.product-variation-section')"
    - "document.querySelector('.variation-area')"
    - "document.querySelector('.product-variation-area')"
    - "document.querySelector('.variation-block')"
    - "document.querySelector('.product-variation-block')"
    - "document.querySelector('.variation-panel')"
    - "document.querySelector('.product-variation-panel')"
    - "document.querySelector('.variation-tab')"
    - "document.querySelector('.product-variation-tab')"
    - "document.querySelector('.variation-content')"
    - "document.querySelector('.product-variation-content')"
    - "document.querySelector('.variation-header')"
    - "document.querySelector('.product-variation-header')"
    - "document.querySelector('.variation-body')"
    - "document.querySelector('.product-variation-body')"
    - "document.querySelector('.variation-footer')"
    - "document.querySelector('.product-variation-footer')"
